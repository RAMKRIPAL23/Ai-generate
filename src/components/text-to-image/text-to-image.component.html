
<div class="h-full flex flex-col gap-6 p-1">
  <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-lg p-6 hover:shadow-2xl transition-shadow">
    <div class="flex items-center gap-4">
      <div class="p-3 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-lg shadow-md">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
      </div>
      <div>
        <h2 class="text-2xl font-bold text-white">Text to Image</h2>
        <p class="text-gray-300">Describe an image and let AI bring it to life.</p>
      </div>
    </div>
  </div>

  <app-api-key-warning />

  <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex-grow flex flex-col">
    <div class="flex flex-col md:flex-row gap-4">
      <textarea [(ngModel)]="prompt" rows="3" class="w-full flex-grow bg-gray-900/50 text-white rounded-lg border border-gray-600 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition p-3" placeholder="e.g., A photo of a cat wearing a small wizard hat"></textarea>
      <button (click)="generateImage()" [disabled]="loading() || isApiKeyValid() !== 'valid' || !prompt().trim()" class="px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg shadow-md hover:bg-purple-700 disabled:bg-gray-500 disabled:cursor-not-allowed transition-all duration-200 border border-purple-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-purple-500 active:scale-95">
        @if (loading()) {
          <span class="flex items-center justify-center">
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Generating...
          </span>
        } @else {
          <span class="flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
            </svg>
            Generate Image
          </span>
        }
      </button>
    </div>

    <div class="mt-6 flex-grow flex items-center justify-center bg-gray-900/30 rounded-lg min-h-[300px] p-4">
      @if (loading()) {
        <app-loader message="Conjuring pixels..." />
      } @else if (imageUrl()) {
        <div class="relative group">
          <img [src]="imageUrl()" alt="Generated image" class="max-h-[50vh] max-w-full object-contain rounded-lg shadow-2xl">
          <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-lg">
            <button (click)="downloadImage()" class="px-4 py-2 bg-white/20 text-white font-semibold rounded-lg backdrop-blur-sm hover:bg-white/30 transition">
              Download
            </button>
          </div>
        </div>
      } @else if(error()) {
        <div class="text-center text-red-400">
            <p>{{ error() }}</p>
        </div>
      } @else {
        <div class="text-center text-gray-400">
          <p>Your generated image will appear here.</p>
        </div>
      }
    </div>
  </div>
</div>
