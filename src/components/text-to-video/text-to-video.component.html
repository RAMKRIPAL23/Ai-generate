
<div class="h-full flex flex-col gap-6 p-1">
  <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-lg p-6 hover:shadow-2xl transition-shadow">
    <div class="flex items-center gap-4">
      <div class="p-3 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg shadow-md">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
        </svg>
      </div>
      <div>
        <h2 class="text-2xl font-bold text-white">Text to Video</h2>
        <p class="text-gray-300">Turn your ideas into captivating video clips.</p>
      </div>
    </div>
  </div>

  <app-api-key-warning />

  <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex-grow flex flex-col">
    <div class="flex flex-col md:flex-row gap-4">
      <textarea [(ngModel)]="prompt" rows="3" class="w-full flex-grow bg-gray-900/50 text-white rounded-lg border border-gray-600 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition p-3" placeholder="e.g., An astronaut riding a horse on Mars"></textarea>
      <button (click)="generateVideo()" [disabled]="loading() || isApiKeyValid() !== 'valid' || !prompt().trim()" class="px-6 py-3 bg-pink-600 text-white font-semibold rounded-lg shadow-md hover:bg-pink-700 disabled:bg-gray-500 disabled:cursor-not-allowed transition-all duration-200 border border-pink-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-pink-500 active:scale-95">
        @if (loading()) {
          <span class="flex items-center justify-center">
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Generating...
          </span>
        } @else {
          <span class="flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            Generate Video
          </span>
        }
      </button>
    </div>

    <div class="mt-6 flex-grow flex items-center justify-center bg-gray-900/30 rounded-lg min-h-[300px] p-4">
      @if (loading()) {
        <app-loader [message]="progressMessage()" />
      } @else if (safeVideoUrl()) {
        <div class="relative group w-full max-w-2xl">
          <video [src]="safeVideoUrl()" controls autoplay loop class="w-full rounded-lg shadow-2xl"></video>
           <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-lg">
            <button (click)="downloadVideo()" class="px-4 py-2 bg-white/20 text-white font-semibold rounded-lg backdrop-blur-sm hover:bg-white/30 transition">
              Download
            </button>
          </div>
        </div>
      } @else if(error()) {
        <div class="text-center text-red-400">
            <p>{{ error() }}</p>
        </div>
      } @else {
        <div class="text-center text-gray-400">
          <p>Your generated video will appear here.</p>
          <p class="text-sm text-yellow-400 mt-2">Note: Video generation can take several minutes.</p>
        </div>
      }
    </div>
  </div>
</div>
